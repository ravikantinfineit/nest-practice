<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>nestjs-starter documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css" media="(prefers-color-scheme: dark)">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">nestjs-starter documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content module">
                   <div class="content-data">



<ol class="breadcrumb">
    <li>Modules</li>
    <li >FilesS3PresignedModule</li>
</ol>

<div class="text-center module-graph-container">
    <div id="module-graph-svg">
        <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.0 (20210316.0004)
 -->
<!-- Title: dependencies Pages: 1 -->
<svg width="504pt" height="284pt"
 viewBox="0.00 0.00 504.00 284.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 280)">
<title>dependencies</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-280 500,-280 500,4 -4,4"/>
<text text-anchor="start" x="227.01" y="-42.4" font-family="Times-12" font-weight="bold" font-size="14.00">Legend</text>
<polygon fill="#ffffb3" stroke="transparent" points="14,-10 14,-30 34,-30 34,-10 14,-10"/>
<text text-anchor="start" x="37.63" y="-15.4" font-family="Times-12" font-size="14.00"> &#160;Declarations</text>
<polygon fill="#8dd3c7" stroke="transparent" points="127,-10 127,-30 147,-30 147,-10 127,-10"/>
<text text-anchor="start" x="150.73" y="-15.4" font-family="Times-12" font-size="14.00"> &#160;Module</text>
<polygon fill="#80b1d3" stroke="transparent" points="213,-10 213,-30 233,-30 233,-10 213,-10"/>
<text text-anchor="start" x="236.78" y="-15.4" font-family="Times-12" font-size="14.00"> &#160;Bootstrap</text>
<polygon fill="#fdb462" stroke="transparent" points="310,-10 310,-30 330,-30 330,-10 310,-10"/>
<text text-anchor="start" x="333.67" y="-15.4" font-family="Times-12" font-size="14.00"> &#160;Providers</text>
<polygon fill="#fb8072" stroke="transparent" points="406,-10 406,-30 426,-30 426,-10 406,-10"/>
<text text-anchor="start" x="429.73" y="-15.4" font-family="Times-12" font-size="14.00"> &#160;Exports</text>
<g id="clust1" class="cluster">
<title>cluster_FilesS3PresignedModule</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="125,-70 125,-268 371,-268 371,-70 125,-70"/>
</g>
<g id="clust6" class="cluster">
<title>cluster_FilesS3PresignedModule_providers</title>
<polygon fill="none" stroke="black" points="133,-78 133,-130 363,-130 363,-78 133,-78"/>
</g>
<g id="clust4" class="cluster">
<title>cluster_FilesS3PresignedModule_exports</title>
<polygon fill="none" stroke="black" points="161,-208 161,-260 335,-260 335,-208 161,-208"/>
</g>
<!-- FilesS3PresignedService  -->
<g id="node1" class="node">
<title>FilesS3PresignedService </title>
<polygon fill="#fb8072" stroke="black" points="327.19,-252 168.81,-252 168.81,-216 327.19,-216 327.19,-252"/>
<text text-anchor="middle" x="248" y="-229.8" font-family="Times,serif" font-size="14.00">FilesS3PresignedService </text>
</g>
<!-- FilesS3PresignedModule -->
<g id="node2" class="node">
<title>FilesS3PresignedModule</title>
<polygon fill="#8dd3c7" stroke="black" points="326.26,-187 323.26,-191 302.26,-191 299.26,-187 169.74,-187 169.74,-151 326.26,-151 326.26,-187"/>
<text text-anchor="middle" x="248" y="-164.8" font-family="Times,serif" font-size="14.00">FilesS3PresignedModule</text>
</g>
<!-- FilesS3PresignedModule&#45;&gt;FilesS3PresignedService  -->
<g id="edge1" class="edge">
<title>FilesS3PresignedModule&#45;&gt;FilesS3PresignedService </title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248,-187.11C248,-187.11 248,-205.99 248,-205.99"/>
<polygon fill="black" stroke="black" points="244.5,-205.99 248,-215.99 251.5,-205.99 244.5,-205.99"/>
</g>
<!-- FilesS3PresignedService -->
<g id="node3" class="node">
<title>FilesS3PresignedService</title>
<ellipse fill="#fdb462" stroke="black" cx="248" cy="-104" rx="107.1" ry="18"/>
<text text-anchor="middle" x="248" y="-99.8" font-family="Times,serif" font-size="14.00">FilesS3PresignedService</text>
</g>
<!-- FilesS3PresignedService&#45;&gt;FilesS3PresignedModule -->
<g id="edge2" class="edge">
<title>FilesS3PresignedService&#45;&gt;FilesS3PresignedModule</title>
<path fill="none" stroke="black" d="M248,-122.11C248,-122.11 248,-140.99 248,-140.99"/>
<polygon fill="black" stroke="black" points="244.5,-140.99 248,-150.99 251.5,-140.99 244.5,-140.99"/>
</g>
</g>
</svg>

    </div>
    <i id="fullscreen" class="icon ion-ios-resize module-graph-fullscreen-btn" aria-hidden="true"></i>
    <div class="btn-group size-buttons">
        <button id="zoom-in" class="btn btn-default btn-sm">Zoom in</button>
        <button id="reset" class="btn btn-default btn-sm">Reset</button>
        <button id="zoom-out" class="btn btn-default btn-sm">Zoom out</button>
    </div>
</div>
<script src="../js/libs/svg-pan-zoom.min.js"></script>
<script src="../js/svg-pan-zoom.controls.js"></script>

<ul class="nav nav-tabs" role="tablist">
    <li  class="active" >
        <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
    </li>
    <li >
        <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
    </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">

        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/modules/files/infrastructure/uploader/s3-presigned/files.module.ts</code>
        </p>



        <p class="comment">
            <h3>Description</h3>
        </p>
        <p class="comment">
            <p>The <code>FilesS3PresignedModule</code> configures and sets up the module for handling file uploads to an Amazon S3 bucket using presigned URLs. It integrates the necessary dependencies and configurations for Multer to manage file uploads and provides the service and controller for handling S3 interactions.</p>
<ul>
<li><p><code>MulterModule</code>: Configured asynchronously to use <code>multer-s3</code> for file storage on S3.</p>
</li>
<li><p><code>ConfigModule</code>: Provides configuration services for retrieving AWS S3 settings.</p>
</li>
<li><p><code>FilesS3PresignedService</code>: Service that handles the logic for interacting with S3 and generating presigned URLs.</p>
</li>
<li><p><code>FilesS3PresignedController</code>: Controller for handling HTTP requests related to file uploads and presigned URLs.</p>
</li>
</ul>

        </p>


        <div class="container-fluid module">
            <div class="row">
                <div class="col-sm-3">
                    <h3>Providers<a href="https://angular.io/api/core/NgModule#providers" target="_blank"
                            title="Official documentation about module providers"><span class="icon ion-ios-information-circle-outline"></a></h3>
                    <ul class="list-group">
                        <li class="list-group-item">
                            <a href="../injectables/FilesS3PresignedService.html">FilesS3PresignedService</a>
                        </li>
                    </ul>
                </div>
                <div class="col-sm-3">
                    <h3>Controllers<a href="https://docs.nestjs.com/controllers" target="_blank" title="Official documentation about module controllers"><span
                                class="icon ion-ios-information-circle-outline"></a></h3>
                    <ul class="list-group">
                        <li class="list-group-item">
                            <a href="../controllers/FilesS3PresignedController.html">FilesS3PresignedController</a>
                        </li>
                    </ul>
                </div>
                <div class="col-sm-3">
                    <h3>Exports<a href="https://angular.io/api/core/NgModule#exports" target="_blank" title="Official documentation about module exports"><span
                                class="icon ion-ios-information-circle-outline"></a></h3>
                    <ul class="list-group">
                        <li class="list-group-item">
                            <a href="../s/FilesS3PresignedService.html">FilesS3PresignedService</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>


    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Module } from &#x27;@nestjs/common&#x27;;
import { randomStringGenerator } from &#x27;@nestjs/common/utils/random-string-generator.util&#x27;;
import { ConfigModule, ConfigService } from &#x27;@nestjs/config&#x27;;
import { MulterModule } from &#x27;@nestjs/platform-express&#x27;;

import { S3Client } from &#x27;@aws-sdk/client-s3&#x27;;
import multerS3 from &#x27;multer-s3&#x27;;

// import { HelperModule } from &#x27;../../../../../common/helper/helper.module&#x27;;
// import { ConfigService } from &#x27;../../../../../common/helper/services/config.service&#x27;;
import { AllConfigType } from &#x27;@config/type/config.type&#x27;;

import { imageFileFilter } from &#x27;../../../../../providers/file-upload.service&#x27;;

import { FilesS3PresignedController } from &#x27;./files.controller&#x27;;
import { FilesS3PresignedService } from &#x27;./files.service&#x27;;

/**
 * @module FilesS3PresignedModule
 *
 * @description
 * The &#x60;FilesS3PresignedModule&#x60; configures and sets up the module for handling file uploads to an Amazon S3 bucket using presigned URLs. It integrates the necessary dependencies and configurations for Multer to manage file uploads and provides the service and controller for handling S3 interactions.
 *
 * @imports
 * - &#x60;MulterModule&#x60;: Configured asynchronously to use &#x60;multer-s3&#x60; for file storage on S3.
 * - &#x60;ConfigModule&#x60;: Provides configuration services for retrieving AWS S3 settings.
 *
 * @providers
 * - &#x60;FilesS3PresignedService&#x60;: Service that handles the logic for interacting with S3 and generating presigned URLs.
 *
 * @controllers
 * - &#x60;FilesS3PresignedController&#x60;: Controller for handling HTTP requests related to file uploads and presigned URLs.
 */
@Module({
    imports: [
        MulterModule.registerAsync({
            imports: [ConfigModule],
            inject: [ConfigService],
            useFactory: (configService: ConfigService&lt;AllConfigType&gt;) &#x3D;&gt; {
                const s3 &#x3D; new S3Client({
                    region: configService.get(&#x27;file.awsS3Region&#x27;, { infer: true }),
                    credentials: {
                        accessKeyId: configService.getOrThrow(&#x27;file.accessKeyId&#x27;, {
                            infer: true,
                        }),
                        secretAccessKey: configService.getOrThrow(&#x27;file.secretAccessKey&#x27;, {
                            infer: true,
                        }),
                    },
                });

                return {
                    fileFilter: imageFileFilter,
                    storage: multerS3({
                        s3: s3,
                        bucket: &#x27;&#x27;,
                        acl: &#x27;public-read&#x27;,
                        contentType: multerS3.AUTO_CONTENT_TYPE,
                        key: (request, file, callback) &#x3D;&gt; {
                            callback(
                                null,
                                &#x60;${randomStringGenerator()}.${file.originalname
                                    .split(&#x27;.&#x27;)
                                    .pop()
                                    ?.toLowerCase()}&#x60;
                            );
                        },
                    }),
                };
            },
        }),
    ],
    controllers: [FilesS3PresignedController],
    providers: [FilesS3PresignedService],
    exports: [FilesS3PresignedService],
})
export class FilesS3PresignedModule {}
</code></pre>
    </div>
</div>










                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'module';
            var COMPODOC_CURRENT_PAGE_URL = 'FilesS3PresignedModule.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       
       <script type="module" src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
