<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>nestjs-starter documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css" media="(prefers-color-scheme: dark)">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">nestjs-starter documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">











<ol class="breadcrumb">
  <li>Classes</li>
  <li >Query</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/modules/currencies/query.ts</code>
        </p>


            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>This file defines the <code>Query</code> class, which provides methods for generating SQL queries
related to currency data management.</p>
<p>The <code>Query</code> class includes methods to generate SQL queries for operations such as
retrieving, inserting, updating, and deleting currency records from the database.
It uses the lodash library for object manipulation and query construction.</p>

            </p>




            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#delete" >delete</a>
                            </li>
                            <li>
                                <a href="#findByCode" >findByCode</a>
                            </li>
                            <li>
                                <a href="#findById" >findById</a>
                            </li>
                            <li>
                                <a href="#insert" >insert</a>
                            </li>
                            <li>
                                <a href="#pgBaseQuery" >pgBaseQuery</a>
                            </li>
                            <li>
                                <a href="#pgBaseSelectField" >pgBaseSelectField</a>
                            </li>
                            <li>
                                <a href="#update" >update</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>



            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="delete"></a>
                    <span class="name">
                        <span ><b>delete</b></span>
                        <a href="#delete"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>delete()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="139"
                            class="link-to-prism">src/modules/currencies/query.ts:139</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Generates a SQL query to delete a currency by its ID.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                    </div>
                    <div class="io-description">
                        <p>The query configuration object with <code>name</code>, <code>type</code>, and <code>syntax</code> properties.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findByCode"></a>
                    <span class="name">
                        <span ><b>findByCode</b></span>
                        <a href="#findByCode"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>findByCode(id?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="49"
                            class="link-to-prism">src/modules/currencies/query.ts:49</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Generates a SQL query to find a currency by its code.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>id</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                    <td>
                                        <ul>
<li>Optional ID to exclude from the search if provided.</li>
</ul>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                    </div>
                    <div class="io-description">
                        <p>The query configuration object with <code>name</code>, <code>type</code>, and <code>syntax</code> properties.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findById"></a>
                    <span class="name">
                        <span ><b>findById</b></span>
                        <a href="#findById"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>findById()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="21"
                            class="link-to-prism">src/modules/currencies/query.ts:21</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Generates a SQL query to find a currency by its ID.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                    </div>
                    <div class="io-description">
                        <p>The query configuration object with <code>name</code>, <code>type</code>, and <code>syntax</code> properties.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="insert"></a>
                    <span class="name">
                        <span ><b>insert</b></span>
                        <a href="#insert"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>insert()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="71"
                            class="link-to-prism">src/modules/currencies/query.ts:71</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Generates a SQL query to insert a new currency.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                    </div>
                    <div class="io-description">
                        <p>The query configuration object with <code>name</code>, <code>type</code>, and <code>syntax</code> properties.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="pgBaseQuery"></a>
                    <span class="name">
                        <span ><b>pgBaseQuery</b></span>
                        <a href="#pgBaseQuery"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>pgBaseQuery()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="172"
                            class="link-to-prism">src/modules/currencies/query.ts:172</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Provides the base query for selecting currencies.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </div>
                    <div class="io-description">
                        <p>The base query string for selecting currencies.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="pgBaseSelectField"></a>
                    <span class="name">
                        <span ><b>pgBaseSelectField</b></span>
                        <a href="#pgBaseSelectField"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>pgBaseSelectField()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="156"
                            class="link-to-prism">src/modules/currencies/query.ts:156</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Provides the base fields for selecting currencies in pagination queries.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>string[]</code>

                    </div>
                    <div class="io-description">
                        <p>An array of column names to be selected in pagination queries.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="update"></a>
                    <span class="name">
                        <span ><b>update</b></span>
                        <a href="#update"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>update()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="100"
                            class="link-to-prism">src/modules/currencies/query.ts:100</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Generates a SQL query to update an existing currency.</p>
</div>

                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                    </div>
                    <div class="io-description">
                        <p>The query configuration object with <code>name</code>, <code>type</code>, and <code>syntax</code> properties.</p>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>





    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import * as _ from &#x27;lodash&#x27;;

/**
 * @fileoverview
 * This file defines the &#x60;Query&#x60; class, which provides methods for generating SQL queries
 * related to currency data management.
 *
 * @module
 * @description
 * The &#x60;Query&#x60; class includes methods to generate SQL queries for operations such as
 * retrieving, inserting, updating, and deleting currency records from the database.
 * It uses the lodash library for object manipulation and query construction.
 */

export class Query {
    /**
     * Generates a SQL query to find a currency by its ID.
     * @returns {object} The query configuration object with &#x60;name&#x60;, &#x60;type&#x60;, and &#x60;syntax&#x60; properties.
     */

    findById(): object {
        return {
            name: &#x60;findById&#x60;,
            type: &#x60;SELECT_ONE&#x60;,
            syntax: (where: any) &#x3D;&gt; {
                const allowedKeys &#x3D; [
                    &#x27;c.id_currency&#x27;,
                    &#x27;c.code&#x27;,
                    &#x27;c.name&#x27;,
                    &#x27;c.name_plural&#x27;,
                    &#x27;c.symbol&#x27;,
                    &#x27;c.symbol_native&#x27;,
                    &#x27;c.decimal_digits&#x27;,
                    &#x27;c.rounding&#x27;,
                ];
                const id &#x3D; _.get(where, &#x27;id&#x27;);
                const sql &#x3D; &#x60;select ${allowedKeys.join()} from currencies c WHERE c.status &#x3D; 1 AND c.id_currency &#x3D; &#x27;${id}&#x27;;&#x60;;
                return sql;
            },
        };
    }

    /**
     * Generates a SQL query to find a currency by its code.
     * @param {string} [id] - Optional ID to exclude from the search if provided.
     * @returns {object} The query configuration object with &#x60;name&#x60;, &#x60;type&#x60;, and &#x60;syntax&#x60; properties.
     */

    findByCode(id?: string): object {
        return {
            name: &#x60;findByCode&#x60;,
            type: &#x60;SELECT_ONE&#x60;,
            syntax: (where: any) &#x3D;&gt; {
                const allowedKeys &#x3D; [&#x27;c.id_currency&#x27;, &#x27;c.code&#x27;];
                const code &#x3D; _.get(where, &#x27;code&#x27;);

                let sql &#x3D; &#x60;SELECT ${allowedKeys.join()} FROM currencies c WHERE c.status &#x3D; 1 AND c.code &#x3D; &#x27;${code}&#x27;&#x60;;
                if (id) {
                    sql +&#x3D; &#x60; AND c.id_currency !&#x3D; &#x27;${id}&#x27;;&#x60;;
                }
                return sql;
            },
        };
    }

    /**
     * Generates a SQL query to insert a new currency.
     * @returns {object} The query configuration object with &#x60;name&#x60;, &#x60;type&#x60;, and &#x60;syntax&#x60; properties.
     */

    insert(): object {
        return {
            name: &#x60;add&#x60;,
            type: &#x60;INSERT&#x60;,
            syntax: (where: any) &#x3D;&gt; {
                const allowedKeys &#x3D; [
                    &#x27;code&#x27;,
                    &#x27;name&#x27;,
                    &#x27;name_plural&#x27;,
                    &#x27;symbol&#x27;,
                    &#x27;symbol_native&#x27;,
                    &#x27;decimal_digits&#x27;,
                    &#x27;rounding&#x27;,
                ];
                const conds &#x3D; _.pick(where, allowedKeys);
                const keys &#x3D; _.keys(conds);
                const values &#x3D; _.values(conds);
                const sql &#x3D; &#x60;insert into currencies (${keys.join()}) values (&#x27;${values.join(&quot;&#x27;,&#x27;&quot;)}&#x27;) RETURNING id_currency as insertid, code;&#x60;;
                console.log(&#x27;QUERY&#x27;, sql);
                return sql;
            },
        };
    }

    /**
     * Generates a SQL query to update an existing currency.
     * @returns {object} The query configuration object with &#x60;name&#x60;, &#x60;type&#x60;, and &#x60;syntax&#x60; properties.
     */

    update(): object {
        return {
            name: &#x60;update&#x60;,
            type: &#x60;UPDATE&#x60;,
            syntax: (where: any) &#x3D;&gt; {
                let sql &#x3D; &#x60;UPDATE currencies SET &#x60;;
                const id &#x3D; _.get(where, &#x27;id&#x27;);
                _.unset(where, &#x27;id&#x27;);
                const allowedKeys &#x3D; [
                    &#x27;code&#x27;,
                    &#x27;name&#x27;,
                    &#x27;name_plural&#x27;,
                    &#x27;symbol&#x27;,
                    &#x27;symbol_native&#x27;,
                    &#x27;decimal_digits&#x27;,
                    &#x27;rounding&#x27;,
                ];
                where &#x3D; _.pick(where, allowedKeys);

                const lastKey &#x3D; Object.keys(where)[Object.keys(where).length - 1];
                _.mapKeys(where, (value, key) &#x3D;&gt; {
                    sql +&#x3D; &#x60;${key} &#x3D; &#x27;${value}&#x27;&#x60;;
                    sql +&#x3D; lastKey &#x3D;&#x3D; key ? &#x60;&#x60; : &#x60;, &#x60;;
                });
                sql +&#x3D; &#x60; WHERE status &#x3D; 1 AND id_currency &#x3D; &#x27;${id}&#x27; RETURNING id_currency as updatedid, code;&#x60;;

                console.log(&#x27;QQQQQQQQQQQQQQ&#x27;, sql);

                return sql;
            },
        };
    }

    /**
     * Generates a SQL query to delete a currency by its ID.
     * @param {string} id - The ID of the currency to delete.
     * @returns {object} The query configuration object with &#x60;name&#x60;, &#x60;type&#x60;, and &#x60;syntax&#x60; properties.
     */

    delete(): object {
        return {
            name: &#x60;delete&#x60;,
            type: &#x60;UPDATE&#x60;,
            syntax: (id: string) &#x3D;&gt; {
                const sql &#x3D; &#x60;UPDATE currencies SET status &#x3D; 127 WHERE status &#x3D; 1 AND id_currency &#x3D; &#x27;${id}&#x27; RETURNING id_currency as deletedid, code;&#x60;;

                return sql;
            },
        };
    }

    /**
     * Provides the base fields for selecting currencies in pagination queries.
     * @returns {string[]} An array of column names to be selected in pagination queries.
     */

    pgBaseSelectField(): string[] {
        return [
            &#x27;ptbl.id_currency&#x27;,
            &#x27;ptbl.code&#x27;,
            &#x27;ptbl.name&#x27;,
            &#x27;ptbl.symbol&#x27;,
            &#x27;ptbl.decimal_digits&#x27;,
            &#x27;ptbl.rounding&#x27;,
        ];
    }

    /**
     * Provides the base query for selecting currencies.
     * @returns {string} The base query string for selecting currencies.
     */

    pgBaseQuery(): string {
        return &#x60; FROM currencies ptbl&#x60;;
    }
}

// import * as _ from &#x27;lodash&#x27;;

// import { DynamicQueryBuilder, QueryOptions } from &#x27;@providers/dynamic-query.service&#x27;;

// export class Query {
//     private queryBuilder &#x3D; new DynamicQueryBuilder();

//     findBy(key: string, value: string, id?: string) {
//         const selectOptions: QueryOptions &#x3D; {
//             table: &#x27;currencies&#x27;,
//             fields: [&#x27;id_currency&#x27;, &#x27;code&#x27;],
//             conditions: { status: 1, ...(key &amp;&amp; { [key]: value }) },
//             ...(id &amp;&amp; {
//                 optionalConditions: {
//                     id_currency: id,
//                 },
//             }),
//         };

//         return this.queryBuilder.buildSelectQuery(selectOptions);
//     }

//     insert(values: any) {
//         const insertOptions: QueryOptions &#x3D; {
//             table: &#x27;currencies&#x27;,
//             fields: [
//                 &#x27;code&#x27;,
//                 &#x27;name&#x27;,
//                 &#x27;name_plural&#x27;,
//                 &#x27;symbol&#x27;,
//                 &#x27;symbol_native&#x27;,
//                 &#x27;decimal_digits&#x27;,
//                 &#x27;rounding&#x27;,
//             ],
//             values: values,
//             returningFields: [&#x27;id_currency as insertid&#x27;, &#x27;code&#x27;],
//         };

//         return this.queryBuilder.buildInsertQuery(insertOptions);
//     }

//     delete(key: string, value: string) {
//         const deleteOptions: QueryOptions &#x3D; {
//             table: &#x27;currencies&#x27;,
//             conditions: { status: 1, ...(key &amp;&amp; { [key]: value }) },
//             returningFields: [&#x27;id_currency as deleteid&#x27;],
//         };

//         return this.queryBuilder.buildDeleteQuery(deleteOptions);
//     }

//     pgBaseSelectField(): string[] {
//         return [
//             &#x27;ptbl.id_currency&#x27;,
//             &#x27;ptbl.code&#x27;,
//             &#x27;ptbl.name&#x27;,
//             &#x27;ptbl.symbol&#x27;,
//             &#x27;ptbl.decimal_digits&#x27;,
//             &#x27;ptbl.rounding&#x27;,
//         ];
//     }

//     pgBaseQuery() {
//         return &#x60; FROM currencies ptbl&#x60;;
//     }
// }
</code></pre>
    </div>
</div>



                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'Query-3.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       
       <script type="module" src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
